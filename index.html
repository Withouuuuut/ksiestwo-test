
<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
    <title>Księstwo Sushi</title>
    <meta name="description" content="A premium, modern digital menu for a high-end sushi restaurant.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;0,700;1,400&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              serif: ['"Cormorant Garamond"', 'serif'],
              sans: ['"Montserrat"', 'sans-serif'],
            },
            colors: {
              brand: {
                dark: '#1a1a1a',
                gold: '#d4af37',
                cream: '#fcfbf9',
                stone: '#e6e2dd',
                muted: '#8c8c8c'
              }
            },
            animation: {
              'fade-in': 'fadeIn 0.5s ease-out forwards',
              'fade-in-up': 'fadeInUp 0.7s ease-out forwards',
            },
            keyframes: {
              fadeIn: {
                '0%': { opacity: '0' },
                '100%': { opacity: '1' },
              },
              fadeInUp: {
                '0%': { opacity: '0', transform: 'translateY(20px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' },
              }
            }
          }
        }
      }
    </script>
    <style>
      html { scroll-behavior: smooth; }
      body { -webkit-tap-highlight-color: transparent; }
      /* Hide scrollbar */
      .no-scrollbar::-webkit-scrollbar { display: none; }
      .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
      
      /* Accordion Transitions */
      .accordion-content {
        transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s ease-in-out;
        max-height: 0;
        opacity: 0;
        overflow: hidden;
      }
      .accordion-content.open {
        max-height: 3000px; /* Arbitrary large number */
        opacity: 1;
      }
      .chevron { transition: transform 0.4s ease; }
      .chevron.rotate { transform: rotate(180deg); }
      
      /* Sticky Nav Active State */
      .nav-btn.active { background-color: #1a1a1a; color: #ffffff; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }

      /* Scroll Reveal Animation */
      .item-row {
        opacity: 0;
        transform: translateY(15px);
        transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        will-change: opacity, transform;
      }
      .item-row.is-visible {
        opacity: 1;
        transform: translateY(0);
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.555.0"
  }
}
</script>
</head>
  <body class="bg-brand-cream text-brand-dark antialiased selection:bg-brand-gold selection:text-white pb-safe relative">

    <!-- Language Switcher (Changed from fixed to absolute to scroll away) -->
    <div class="absolute top-6 right-6 z-50 animate-fade-in">
      <div class="flex bg-white/90 backdrop-blur-sm rounded-full shadow-lg p-1 border border-brand-stone">
        <button onclick="setLanguage('pl')" id="btn-pl" class="px-4 py-1.5 rounded-full text-xs font-bold tracking-widest transition-all duration-300 bg-brand-dark text-white shadow-md">PL</button>
        <button onclick="setLanguage('en')" id="btn-en" class="px-4 py-1.5 rounded-full text-xs font-bold tracking-widest transition-all duration-300 text-brand-muted hover:text-brand-dark">EN</button>
      </div>
    </div>

    <!-- Header -->
    <header class="pt-24 pb-12 px-6 text-center relative overflow-hidden">
      <div class="relative z-10 animate-fade-in-up">
        <div class="w-16 h-16 mx-auto bg-brand-gold/10 rounded-full flex items-center justify-center mb-6 shadow-sm border border-brand-gold/20">
           <span class="font-serif font-bold text-2xl text-brand-dark">KS</span>
        </div>
        <h1 class="font-serif text-4xl md:text-6xl font-medium text-brand-dark mb-3 tracking-tight">Księstwo Sushi</h1>
        <p id="header-subtitle" class="font-sans text-brand-muted text-xs md:text-sm tracking-[0.3em] uppercase">Wyborne Sushi — Menu</p>
      </div>
      <div class="absolute top-0 left-1/2 -translate-x-1/2 w-[120%] h-full bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-white via-transparent to-transparent opacity-60 -z-10 pointer-events-none"></div>
    </header>

    <!-- Sticky Nav -->
    <nav class="sticky top-0 z-40 bg-brand-cream/85 backdrop-blur-md border-b border-brand-stone/50 shadow-sm transition-all duration-300">
      <div class="max-w-4xl mx-auto px-4">
        <div id="nav-container" class="flex overflow-x-auto no-scrollbar py-4 gap-2 md:justify-center md:gap-6">
          <!-- Nav items injected by JS -->
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main id="menu-container" class="max-w-4xl mx-auto px-4 py-8 space-y-12 pb-24">
      <!-- Menu Sections injected by JS -->
    </main>

    <!-- Footer -->
    <footer class="py-16 bg-brand-dark text-brand-stone rounded-t-[2rem]">
      <div class="container mx-auto px-6 text-center">
        <h2 class="font-serif text-3xl mb-1 text-white">Księstwo Sushi</h2>
        <p id="footer-subtitle" class="font-sans text-xs text-brand-muted uppercase tracking-[0.2em] mb-10">Wyborne Sushi</p>
        
        <div class="flex flex-col md:flex-row justify-center items-center gap-6 mb-12">
          <a href="tel:+48502525544" class="flex items-center gap-3 px-6 py-4 rounded-full bg-white/5 hover:bg-white/10 transition-colors border border-white/10 group w-full md:w-auto justify-center">
            <img src="images/phone.png" alt="Phone" class="w-5 h-5 object-contain opacity-90">
            <span class="font-sans font-medium text-sm">+48 502 525 544</span>
          </a>
          <a href="https://www.instagram.com/ksiestwosushi" target="_blank" class="flex items-center gap-3 px-6 py-4 rounded-full bg-white/5 hover:bg-white/10 transition-colors border border-white/10 group w-full md:w-auto justify-center">
            <img src="images/instagram.png" alt="Instagram" class="w-5 h-5 object-contain opacity-90">
            <span class="font-sans font-medium text-sm">@ksiestwosushi</span>
          </a>
          <a href="https://maps.app.goo.gl/1WmFXGEPnDcBiz3p9" target="_blank" class="flex items-center gap-3 px-6 py-4 rounded-full bg-white/5 hover:bg-white/10 transition-colors border border-white/10 group w-full md:w-auto justify-center">
            <img src="images/google_maps.png" alt="Maps" class="w-5 h-5 object-contain opacity-90">
            <span class="font-sans font-medium text-sm">Krupówki 38A, Zakopane</span>
          </a>
        </div>
        
        <div class="w-16 h-px bg-brand-gold/30 mx-auto mb-8"></div>
        <p id="footer-copy" class="text-xs text-brand-muted font-sans opacity-60"></p>
      </div>
    </footer>

    <!-- Lightbox -->
    <div id="lightbox" class="fixed inset-0 z-[100] flex items-center justify-center bg-black/95 backdrop-blur-sm transition-opacity duration-300 opacity-0 pointer-events-none" onclick="closeLightbox()">
      <button class="absolute top-6 right-6 text-white/70 hover:text-white transition-colors">
        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
      </button>
      <div class="relative max-w-5xl w-[90vw] max-h-[90vh] flex items-center justify-center p-2" onclick="event.stopPropagation()">
        <img id="lightbox-img" src="" alt="Full view" class="max-w-full max-h-[85vh] object-contain rounded-sm shadow-2xl">
      </div>
    </div>

    <!-- Data & Logic -->
    <script>
      // --- DATA ---
      const MENU_DATA = [
        {
          id: 'starters',
          title: { en: 'Starters', pl: 'Przystawki' },
          introPhoto: 'images/sake-tataki.jpg',
          introDescEN: 'A selection of light and fresh starters to begin your sushi experience.',
          introDescPL: 'Wybór lekkich i świeżych przystawek na rozpoczęcie przygody z sushi.',
          items: [
            { enName: 'Goma Wakame', plName: 'Goma Wakame', descEN: 'Wakame salad with sesame', descPL: 'Sałatka wakame z sezamem', price: '20 zł' },
            { enName: 'Ebiten (3 pcs)', plName: 'Ebiten (3 szt.)', descEN: 'Shrimp tempura served with ponzu sauce', descPL: 'Krewetka w tempurze z sosem ponzu', price: '30 zł' },
            { enName: 'Sake Tataki', plName: 'Sake Tataki', descEN: 'Salmon tartare with distinct flavors', descPL: 'Tatar z łososia o wyrazistym smaku', price: '50 zł' },
            { enName: 'Maguro Tataki', plName: 'Maguro Tataki', descEN: 'Tuna tartare delicately seasoned', descPL: 'Tatar z tuńczyka delikatnie przyprawiony', price: '55 zł' }
          ]
        },
        {
          id: 'soups',
          title: { en: 'Soups', pl: 'Zupy' },
          introPhoto: 'images/ramen-zupa.jpg',
          introDescEN: 'Traditional Japanese soups, including rich Ramen bowls with various fillings.',
          introDescPL: 'Tradycyjne japońskie zupy, w tym bogate miski Ramenu z różnymi dodatkami.',
          smallNoteEN: 'The Ramen portion is 800ml, recommended for sharing (2 people).',
          smallNotePL: 'Uwaga: Porcja Ramenu to 800ml, polecamy do podziału (dla 2 osób).',
          items: [
            { enName: 'Ramen Chicken', plName: 'Ramen Chicken', descEN: 'Flavorful broth with chicken, vegetables, and ramen noodles', descPL: 'Bulion z warzywami, kurczakiem i makaronem ramen', price: '48 zł' },
            { enName: 'Ramen Beef', plName: 'Ramen Beef', descEN: 'Rich broth with tender beef, vegetables, and noodles', descPL: 'Bogaty bulion z delikatną wołowiną, warzywami i makaronem', price: '55 zł' }
          ]
        },
        {
          id: 'nigiri',
          title: { en: 'Nigiri (2 pcs)', pl: 'Nigiri (2 szt.)' },
          introPhoto: 'images/nigiri1.jpg',
          introDescEN: 'Hand-pressed rice topped with premium fresh fish or seafood.',
          introDescPL: 'Ręcznie formowany ryż z plastrem świeżej ryby najwyższej jakości.',
          items: [
            { enName: 'Sake', plName: 'Sake', descEN: 'Salmon', descPL: 'Łosoś', price: '26 zł' },
            { enName: 'Ohio', plName: 'Ohio', descEN: 'Butterfish', descPL: 'Ryba maślana', price: '25 zł' },
            { enName: 'Maguro', plName: 'Maguro', descEN: 'Tuna', descPL: 'Tuńczyk', price: '30 zł' },
            { enName: 'Unagi', plName: 'Unagi', descEN: 'Eel', descPL: 'Węgorz', price: '30 zł' },
            { enName: 'Hotate', plName: 'Hotate', descEN: 'Scallops', descPL: 'Małże św. Jakuba', price: '32 zł' },
            { enName: 'Tako', plName: 'Tako', descEN: 'Octopus', descPL: 'Ośmiornica', price: '30 zł' },
            { enName: 'Ika', plName: 'Ika', descEN: 'Squid', descPL: 'Kalmar', price: '30 zł' },
            { enName: 'Ebi', plName: 'Ebi', descEN: 'Shrimp', descPL: 'Krewetka', price: '30 zł' }
          ]
        },
        {
          id: 'futomaki',
          title: { en: 'Futomaki (6 pcs)', pl: 'Futomaki (6 szt.)' },
          introPhoto: 'images/futomaki.jpg',
          introDescEN: 'Thick, traditional rolls with nori on the outside, filled with abundance.',
          introDescPL: 'Grube, tradycyjne rolki z nori na zewnątrz, bogato wypełnione.',
          items: [
            { enName: 'Sake Philadelphia', plName: 'Sake Philadelphia', descEN: 'Salmon with Philadelphia cream cheese', descPL: 'Łosoś z serkiem Philadelphia', price: '38 zł' },
            { enName: 'Maguro Negi Togarashi', plName: 'Maguro Negi Togarashi', descEN: 'Tuna with spicy leek', descPL: 'Tuńczyk z ostrą dymką', price: '42 zł' },
            { enName: 'Ohio Spice Mango', plName: 'Ohio Spice Mango', descEN: 'Spicy butterfish with mango', descPL: 'Pikantna ryba maślana z mango', price: '40 zł' },
            { enName: 'Ebi Spicy', plName: 'Ebi Spicy', descEN: 'Spicy shrimp', descPL: 'Pikantna krewetka', price: '40 zł' },
            { enName: 'Ebi Tempura', plName: 'Ebi Tempura', descEN: 'Shrimp tempura', descPL: 'Krewetka w tempurze', price: '40 zł' },
            { enName: 'Unagi Kabayaki', plName: 'Unagi Kabayaki', descEN: 'Grilled eel with kabayaki sauce', descPL: 'Grillowany węgorz w sosie kabayaki', price: '45 zł' },
            { enName: 'Ika Tempura', plName: 'Ika Tempura', descEN: 'Squid tempura', descPL: 'Kalmar w tempurze', price: '48 zł' },
            { enName: 'Veggie', plName: 'Veggie', descEN: 'Assorted seasonal vegetables', descPL: 'Warzywa sezonowe', price: '36 zł' }
          ]
        },
        {
          id: 'uramaki-combined',
          title: { en: 'Uramaki & Tempura (8 pcs)', pl: 'Uramaki & Tempura (8 szt.)' },
          introPhoto: 'images/tempura.jpg',
          introDescEN: 'Our selection of Uramaki (inside-out rolls) and crispy Tempura Uramaki.',
          introDescPL: 'Nasz wybór Uramaki (rolek ryżem na zewnątrz) oraz chrupiących Uramaki w Tempurze.',
          subSections: [
            {
              titleEN: 'Classic Uramaki',
              titlePL: 'Klasyczne Uramaki',
              items: [
                { enName: 'Sake Philadelphia', plName: 'Sake Philadelphia', descEN: 'Salmon with Philadelphia cream cheese', descPL: 'Łosoś z serkiem Philadelphia', price: '38 zł' },
                { enName: 'Awokado Sake', plName: 'Awokado Sake', descEN: 'Salmon wrapped in avocado', descPL: 'Łosoś owijany awokado', price: '42 zł' },
                { enName: 'Mango Sake', plName: 'Mango Sake', descEN: 'Salmon wrapped in mango', descPL: 'Łosoś owijany mango', price: '42 zł' },
                { enName: 'Maguro Orange Pepper', plName: 'Maguro Orange Pepper', descEN: 'Tuna with chopped leek and orange pepper', descPL: 'Tuńczyk z siekanym porem i orange pepper', price: '45 zł' },
                { enName: 'Ebi Ten Mamemori', plName: 'Ebi Ten Mamemori', descEN: 'Shrimp tempura wrapped in soy paper', descPL: 'Krewetka w tempurze zawijana w papier sojowy', price: '42 zł' },
                { enName: 'Gold California', plName: 'Gold California', descEN: 'Surimi wrapped in salmon', descPL: 'Surimi owijane łososiem', price: '40 zł' },
                { enName: 'Rainbow', plName: 'Rainbow', descEN: 'Surimi wrapped in assorted fish', descPL: 'Surimi owijane wachlarzem ryb', price: '48 zł' },
                { enName: 'Ohio Spice Sake', plName: 'Ohio Spice Sake', descEN: 'Salmon wrapped in butterfish', descPL: 'Łosoś owijany opalaną maślaną', price: '42 zł' },
                { enName: 'Maguro Spicy Ebi Ten', plName: 'Maguro Spicy Ebi Ten', descEN: 'Shrimp tempura wrapped in seared tuna', descPL: 'Krewetka w tempurze owijana opalanym tuńczykiem', price: '45 zł' },
                { enName: 'Kegon', plName: 'Kegon', descEN: 'Salmon wrapped in grilled eel', descPL: 'Łosoś owijany grillowanym węgorzem', price: '45 zł' },
                { enName: 'Sake Aburi', plName: 'Sake Aburi', descEN: 'Salmon wrapped in seared spicy salmon', descPL: 'Łosoś owijany opalanym pikantnym łososiem', price: '45 zł' },
                { enName: 'Tobiko Ohio Ten', plName: 'Tobiko Ohio Ten', descEN: 'Butterfish in tempura coated with caviar', descPL: 'Maślana w tempurze obtoczona kawiorem', price: '48 zł' },
                { enName: 'Nashi Sake', plName: 'Nashi Sake', descEN: 'Salmon wrapped in Japanese pear', descPL: 'Łosoś owijany japońską gruszką', price: '45 zł' },
                { enName: 'Sake Tataki Ebiten', plName: 'Sake Tataki Ebiten', descEN: 'Shrimp tempura wrapped in salmon tartare', descPL: 'Krewetka w tempurze obtoczona tatarem z łososia', price: '48 zł' }
              ]
            },
            {
              titleEN: 'Tempura Uramaki',
              titlePL: 'Uramaki w Tempurze',
              items: [
                { enName: 'Tempura Sake', plName: 'Tempura Sake', descEN: 'Salmon', descPL: 'Łosoś', price: '38 zł' },
                { enName: 'Tempura Ohio', plName: 'Tempura Ohio', descEN: 'Butterfish', descPL: 'Ryba maślana', price: '38 zł' },
                { enName: 'Tempura Maguro', plName: 'Tempura Maguro', descEN: 'Tuna', descPL: 'Tuńczyk', price: '42 zł' },
                { enName: 'Tempura Ebi', plName: 'Tempura Ebi', descEN: 'Steamed shrimp', descPL: 'Parzona krewetka', price: '40 zł' },
                { enName: 'Tempura Unagi Kabayaki', plName: 'Tempura Unagi Kabayaki', descEN: 'Grilled eel', descPL: 'Grillowany węgorz', price: '45 zł' }
              ]
            }
          ]
        },
        {
          id: 'oyakomaki',
          title: { en: 'Oyakomaki (2 pcs)', pl: 'Oyakomaki (2 szt.)' },
          introPhoto: 'images/oyakomaki.jpg',
          introDescEN: 'Our specialty rolls, often wrapped in fish or avocado instead of nori.',
          introDescPL: 'Nasze specjalne rolki, często zawijane w rybę lub awokado zamiast nori.',
          items: [
            { enName: 'Sake Ebi Tataki', plName: 'Sake Ebi Tataki', descEN: 'Chopped shrimp wrapped in salmon', descPL: 'Siekana krewetka owijana w łososia', price: '36 zł' },
            { enName: 'Sake Ikura', plName: 'Sake Ikura', descEN: 'Caviar with salmon wrapped in tuna', descPL: 'Kawior z łososia owijany tuńczykiem', price: '42 zł' },
            { enName: 'Maguro Sake Tataki', plName: 'Maguro Sake Tataki', descEN: 'Chopped salmon wrapped in tuna', descPL: 'Siekany łosoś owijany tuńczykiem', price: '45 zł' }
          ]
        },
        {
          id: 'sashimi',
          title: { en: 'Sashimi (9 pcs)', pl: 'Sashimi (9 szt.)' },
          introPhoto: 'images/sashimi.jpg',
          introDescEN: 'Thinly sliced raw fish and seafood, served without rice for the purest taste.',
          introDescPL: 'Cienko krojone plastry surowej ryby i owoców morza, podawane bez ryżu.',
          items: [
            { enName: 'Mizu', plName: 'Mizu', descEN: 'Selection of raw fish — salmon, tuna, butterfish', descPL: 'Plastry surowej ryby — łosoś, tuńczyk, maślana', price: '95 zł' }
          ]
        }
      ];

      // --- LOGIC ---
      let LANG = 'pl';
      
      // Intersection Observer for animations
      const scrollObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            scrollObserver.unobserve(entry.target); // Animate once
          }
        });
      }, {
        threshold: 0.1,
        rootMargin: '0px 0px -20px 0px' // Trigger slightly before bottom
      });

      function setupScrollAnimations() {
        document.querySelectorAll('.item-row').forEach(el => {
          // Reset state if needed, though usually we want them to stay visible once shown
          scrollObserver.observe(el);
        });
      }
      
      // Initial Render
      document.addEventListener('DOMContentLoaded', () => {
        renderAll();
        setupScrollSpy();
      });

      function setLanguage(lang) {
        if (LANG === lang) return;
        LANG = lang;
        renderAll();
      }

      function renderAll() {
        // Update Buttons
        const btnPl = document.getElementById('btn-pl');
        const btnEn = document.getElementById('btn-en');
        if (LANG === 'pl') {
          btnPl.className = 'px-4 py-1.5 rounded-full text-xs font-bold tracking-widest transition-all duration-300 bg-brand-dark text-white shadow-md';
          btnEn.className = 'px-4 py-1.5 rounded-full text-xs font-bold tracking-widest transition-all duration-300 text-brand-muted hover:text-brand-dark';
        } else {
          btnEn.className = 'px-4 py-1.5 rounded-full text-xs font-bold tracking-widest transition-all duration-300 bg-brand-dark text-white shadow-md';
          btnPl.className = 'px-4 py-1.5 rounded-full text-xs font-bold tracking-widest transition-all duration-300 text-brand-muted hover:text-brand-dark';
        }

        // Update Static Text
        document.getElementById('header-subtitle').textContent = LANG === 'en' ? 'Fine Sushi — Menu' : 'Wyborne Sushi — Menu';
        document.getElementById('footer-subtitle').textContent = LANG === 'en' ? 'Fine Sushi Experience' : 'Wyborne Sushi';
        document.getElementById('footer-copy').textContent = `© ${new Date().getFullYear()} Księstwo Sushi. ${LANG === 'en' ? 'All rights reserved.' : 'Wszelkie prawa zastrzeżone.'}`;

        // Render Nav
        const navContainer = document.getElementById('nav-container');
        navContainer.innerHTML = MENU_DATA.map((section, index) => `
          <button 
            onclick="scrollToSection('${section.id}')" 
            class="nav-btn whitespace-nowrap px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 ${index === 0 ? 'active' : 'text-brand-muted hover:text-brand-dark hover:bg-white'}" 
            data-target="${section.id}"
          >
            ${LANG === 'en' ? section.title.en : section.title.pl}
          </button>
        `).join('');

        // Render Menu Sections
        const menuContainer = document.getElementById('menu-container');
        // Clear current content carefully to avoid jank if possible, but innerHTML is simplest
        menuContainer.innerHTML = MENU_DATA.map(section => createSectionHTML(section)).join('');
        
        // Setup animations after render
        setTimeout(setupScrollAnimations, 100);
      }

      function createSectionHTML(section) {
        const title = LANG === 'en' ? section.title.en : section.title.pl;
        const introDesc = LANG === 'en' ? section.introDescEN : section.introDescPL;
        const smallNote = LANG === 'en' ? section.smallNoteEN : section.smallNotePL;
        const viewText = LANG === 'en' ? 'View Image' : 'Zobacz zdjęcie';
        const expandText = LANG === 'en' ? 'View Menu' : 'Pokaż Menu';
        const collapseText = LANG === 'en' ? 'Hide Menu' : 'Ukryj Menu';

        let itemsHTML = '';

        if (section.items) {
          itemsHTML = `<div class="grid grid-cols-1 gap-1">${section.items.map(item => createItemHTML(item)).join('')}</div>`;
        } else if (section.subSections) {
          itemsHTML = `<div class="grid grid-cols-1 md:grid-cols-2 gap-12">
            ${section.subSections.map(sub => `
              <div class="flex flex-col">
                <h3 class="font-serif text-2xl text-brand-dark mb-6 pb-2 border-b border-brand-gold/30">${LANG === 'en' ? sub.titleEN : sub.titlePL}</h3>
                <div class="grid grid-cols-1 gap-1">
                  ${sub.items.map(item => createItemHTML(item)).join('')}
                </div>
              </div>
            `).join('')}
          </div>`;
        }

        return `
          <section id="${section.id}" class="scroll-mt-32 bg-white rounded-xl overflow-hidden shadow-[0_4px_30px_rgba(0,0,0,0.03)] border border-brand-stone/30">
            <!-- Hero Image -->
            <div class="relative group cursor-pointer overflow-hidden aspect-[21/9] md:aspect-[3/1]" onclick="openLightbox('${section.introPhoto}')">
              <img src="${section.introPhoto}" alt="${title}" loading="lazy" class="w-full h-full object-cover transition-transform duration-700 ease-out group-hover:scale-105">
              <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-80 transition-opacity duration-300"></div>
              <div class="absolute bottom-0 left-0 w-full p-6 md:p-8 text-white">
                <h2 class="font-serif text-3xl md:text-4xl lg:text-5xl font-light mb-2 tracking-wide">${title}</h2>
                <div class="flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 transform translate-y-2 group-hover:translate-y-0">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line><line x1="11" y1="8" x2="11" y2="14"></line><line x1="8" y1="11" x2="14" y2="11"></line></svg>
                  <span class="text-xs font-sans tracking-widest uppercase">${viewText}</span>
                </div>
              </div>
            </div>

            <!-- Intro Text -->
            <div class="p-6 md:p-8 border-b border-brand-stone/30">
              <p class="font-serif text-xl text-brand-dark/80 italic leading-relaxed text-center max-w-2xl mx-auto">"${introDesc}"</p>
              ${smallNote ? `<p class="text-center text-xs text-brand-muted mt-4 font-sans uppercase tracking-widest">${smallNote}</p>` : ''}
            </div>

            <!-- Accordion Button -->
            <button onclick="toggleSection('${section.id}')" class="w-full flex flex-col items-center justify-center py-4 bg-brand-cream/50 hover:bg-brand-cream transition-colors border-b border-brand-stone/30 group">
              <span id="btn-text-${section.id}" class="font-sans text-xs font-bold tracking-[0.2em] text-brand-gold uppercase mb-1">${expandText}</span>
              <svg id="chevron-${section.id}" class="chevron text-brand-gold" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
            </button>

            <!-- Collapsible Content -->
            <div id="content-${section.id}" class="accordion-content">
              <div class="p-6 md:p-8">
                ${itemsHTML}
              </div>
            </div>
          </section>
        `;
      }

      function createItemHTML(item) {
        const name = LANG === 'en' ? item.enName : item.plName;
        const desc = LANG === 'en' ? item.descEN : item.descPL;
        // Added 'item-row' class for scroll animation
        return `
          <div class="item-row group flex justify-between items-start py-5 border-b border-brand-stone/40 last:border-0 transition-colors duration-300 hover:bg-brand-cream/50 px-2 rounded-lg">
            <div class="flex-1 pr-6">
              <h4 class="font-serif text-lg font-medium text-brand-dark mb-1 group-hover:text-brand-gold transition-colors duration-300">${name}</h4>
              <p class="font-sans text-sm text-brand-muted font-light leading-relaxed">${desc}</p>
            </div>
            <div class="shrink-0">
              <span class="font-serif font-semibold text-lg text-brand-dark">${item.price}</span>
            </div>
          </div>
        `;
      }

      function toggleSection(id) {
        const content = document.getElementById(`content-${id}`);
        const chevron = document.getElementById(`chevron-${id}`);
        const btnText = document.getElementById(`btn-text-${id}`);
        
        content.classList.toggle('open');
        chevron.classList.toggle('rotate');
        
        const isOpen = content.classList.contains('open');
        const expandText = LANG === 'en' ? 'View Menu' : 'Pokaż Menu';
        const collapseText = LANG === 'en' ? 'Hide Menu' : 'Ukryj Menu';
        
        btnText.textContent = isOpen ? collapseText : expandText;
        
        if (isOpen) {
           // Wait for expansion then check visibility
           setTimeout(setupScrollAnimations, 100);
        }
      }

      function scrollToSection(id) {
        const el = document.getElementById(id);
        if (el) {
          const y = el.getBoundingClientRect().top + window.pageYOffset - 120; // Offset for sticky nav
          window.scrollTo({ top: y, behavior: 'smooth' });
        }
      }

      function setupScrollSpy() {
        const navBtns = document.querySelectorAll('.nav-btn');
        const sections = MENU_DATA.map(s => document.getElementById(s.id));

        window.addEventListener('scroll', () => {
          const scrollPos = window.scrollY + 200; // Offset for trigger point

          let currentId = '';
          for (const section of sections) {
            if (section && section.offsetTop <= scrollPos) {
              currentId = section.id;
            }
          }

          navBtns.forEach(btn => {
            if (btn.dataset.target === currentId) {
              btn.classList.add('active', 'bg-brand-dark', 'text-white', 'shadow-md');
              btn.classList.remove('text-brand-muted', 'hover:text-brand-dark', 'hover:bg-white');
              
              // Scroll nav to keep button in view
              btn.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
            } else {
              btn.classList.remove('active', 'bg-brand-dark', 'text-white', 'shadow-md');
              btn.classList.add('text-brand-muted', 'hover:text-brand-dark', 'hover:bg-white');
            }
          });
        });
      }

      // --- Lightbox Logic ---
      function openLightbox(src) {
        const lb = document.getElementById('lightbox');
        const img = document.getElementById('lightbox-img');
        img.src = src;
        lb.classList.remove('opacity-0', 'pointer-events-none');
        document.body.style.overflow = 'hidden';
      }

      function closeLightbox() {
        const lb = document.getElementById('lightbox');
        lb.classList.add('opacity-0', 'pointer-events-none');
        document.body.style.overflow = '';
      }
    </script>
  </body>
</html>
